---
id: 114801
author: Colin Eberhardt
tags: 
- codeproject
- mvvm
- visiblox
categories: 
- Blog
layout: ceberhardt_post
---

<p><em>This post describes a method of using attached properties to bind a ViewModel which contains multiple data series to a Visiblox chart without any code-behind.</em></p>
<p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/03/harmonic.png" alt="" title="harmonic" width="389" height="253" class="aligncenter size-full wp-image-1247" /><br /><br/><br />The <a href="http://www.visiblox.com">Visiblox chart</a> supports databinding in both WPF and Silverlight, where the X and Y values for each datapoint are bound to properties on an underlying model. However, there is no interface for binding a varying number of series (i.e a collection of collections). The solution provided here is similar to the one which Jeremiah Morrill published for <a href="http://jmorrill.hjtcentral.com/Home/tabid/428/EntryId/351/Silverlight-Charts-Binding-multiple-Series.aspx">binding multiple series to the Silverlight Toolkit charts</a>, but with a few added extras, like series title binding and series type selection.</p>
<p>The solution is surprisingly simple, so I am going to dive straight into the code (note, I have collapsed the verbose attached property definitions so that just the interesting bits are shown below!)</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">class</span> MultiSeries
<span style="color: #008000;">&#123;</span>
  <span style="color: #008080;">#region TitlePath attached property</span>
&nbsp;
  <span style="color: #008080;">#region ItemsSourcePath attached property</span>
&nbsp;
  <span style="color: #008080;">#region XValuePath attached property</span>
&nbsp;
  <span style="color: #008080;">#region YValuePath attached property</span>
&nbsp;
  <span style="color: #008080;">#region ChartTypeProvider attached property</span>
&nbsp;
  <span style="color: #008080;">#region Source attached property</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
  <span style="color: #008080; font-style: italic;">/// Handles property changed event for the Source property</span>
  <span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
  <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> OnSourcePropertyChanged<span style="color: #008000;">&#40;</span>DependencyObject d,
                                                      DependencyPropertyChangedEventArgs e<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    Chart targetChart <span style="color: #008000;">=</span> d <span style="color: #0600FF; font-weight: bold;">as</span> Chart<span style="color: #008000;">;</span>
&nbsp;
    SynchroniseChartWithSource<span style="color: #008000;">&#40;</span>targetChart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
    IEnumerable Source <span style="color: #008000;">=</span> GetSource<span style="color: #008000;">&#40;</span>targetChart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    INotifyCollectionChanged incc <span style="color: #008000;">=</span> Source <span style="color: #0600FF; font-weight: bold;">as</span> INotifyCollectionChanged<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>incc <span style="color: #008000;">!=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
      incc<span style="color: #008000;">.</span><span style="color: #0000FF;">CollectionChanged</span> <span style="color: #008000;">+=</span> <span style="color: #008000;">&#40;</span>s, e2<span style="color: #008000;">&#41;</span> <span style="color: #008000;">=&gt;</span> SynchroniseChartWithSource<span style="color: #008000;">&#40;</span>targetChart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
&nbsp;
  <span style="color: #008000;">&#125;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> SynchroniseChartWithSource<span style="color: #008000;">&#40;</span>Chart chart<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    chart<span style="color: #008000;">.</span><span style="color: #0000FF;">Series</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Clear</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
    IEnumerable Source <span style="color: #008000;">=</span> GetSource<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>Source <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span>
      <span style="color: #0600FF; font-weight: bold;">return</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// iterate over each source series</span>
    <span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> seriesDataSource <span style="color: #0600FF; font-weight: bold;">in</span> Source<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
      <span style="color: #008080; font-style: italic;">// create a visiblox chart series</span>
      IChartSeries chartSeries <span style="color: #008000;">=</span> GetChartTypeProvider<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetSeries</span><span style="color: #008000;">&#40;</span>seriesDataSource<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// resolve the ItemsSource path (if present).</span>
      var itemsSourcePath <span style="color: #008000;">=</span> GetItemsSourcePath<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      IEnumerable itemsSource <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
      <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">!</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">.</span><span style="color: #0000FF;">IsNullOrEmpty</span><span style="color: #008000;">&#40;</span>itemsSourcePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #008000;">&#123;</span>
        itemsSource <span style="color: #008000;">=</span> seriesDataSource<span style="color: #008000;">.</span><span style="color: #0000FF;">GetPropertyValue</span><span style="color: #008000;">&lt;</span>IEnumerable<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>itemsSourcePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      <span style="color: #008000;">&#125;</span>
      <span style="color: #0600FF; font-weight: bold;">else</span>
      <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// if not present, assume this is a collection of collections</span>
        itemsSource <span style="color: #008000;">=</span> seriesDataSource <span style="color: #0600FF; font-weight: bold;">as</span> IEnumerable<span style="color: #008000;">;</span>
      <span style="color: #008000;">&#125;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// resolve the title path</span>
      var titlePath <span style="color: #008000;">=</span> GetTitlePath<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      var seriesTitle <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">;</span>
      <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">!</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">.</span><span style="color: #0000FF;">IsNullOrEmpty</span><span style="color: #008000;">&#40;</span>titlePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #008000;">&#123;</span>
        seriesTitle <span style="color: #008000;">=</span> seriesDataSource<span style="color: #008000;">.</span><span style="color: #0000FF;">GetPropertyValue</span><span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>titlePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      <span style="color: #008000;">&#125;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// create the data series, and add to the chart.</span>
      chartSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">DataSeries</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> BindableDataSeries<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #008000;">&#123;</span>
        XValueBinding <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Binding<span style="color: #008000;">&#40;</span>GetXValuePath<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>,
        YValueBinding <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Binding<span style="color: #008000;">&#40;</span>GetYValuePath<span style="color: #008000;">&#40;</span>chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>,
        ItemsSource <span style="color: #008000;">=</span> itemsSource,
        Title <span style="color: #008000;">=</span> seriesTitle
      <span style="color: #008000;">&#125;</span><span style="color: #008000;">;</span>
      chart<span style="color: #008000;">.</span><span style="color: #0000FF;">Series</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Add</span><span style="color: #008000;">&#40;</span>chartSeries<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
  <span style="color: #008000;">&#125;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
  <span style="color: #008080; font-style: italic;">/// Gets the value of the named property.</span>
  <span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
  <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> T GetPropertyValue<span style="color: #008000;">&lt;</span>T<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span> <span style="color: #6666cc; font-weight: bold;">object</span> source, <span style="color: #6666cc; font-weight: bold;">string</span> propertyName<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    var property <span style="color: #008000;">=</span> source<span style="color: #008000;">.</span><span style="color: #0000FF;">GetType</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetProperty</span><span style="color: #008000;">&#40;</span>propertyName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>property <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
      <span style="color: #0600FF; font-weight: bold;">throw</span> <span style="color: #008000;">new</span> ArgumentException<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Format</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;The property {0} does not exist on the type {1}&quot;</span>,
        propertyName, source<span style="color: #008000;">.</span><span style="color: #0000FF;">GetType</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>T<span style="color: #008000;">&#41;</span>property<span style="color: #008000;">.</span><span style="color: #0000FF;">GetValue</span><span style="color: #008000;">&#40;</span>source, <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<p>The <code>MultiSeries</code> class defines a number of attached properties, <code>Source</code> is used to bind the collection of series, this property must be an <code>IEnumerable</code>, but if it also implements <code>INotifyCollectionChanged</code>, we handle the <code>CollectionChanged </code>events to update the chart (adding or removing series). The optional <code>ItemsSourcePath</code> is used to provide the path to the nested collection (more on this later) and the optional <code>TitlePath</code> binds the chart title. The <code>XValuePath</code> and <code>YValuePath</code> properties are used to bind the X &#038; Y values of the chart. Finally, <code>ChartTypeProvider</code> is used to determine the series type (Line, Bar, Column &#8230;) for each of the bound series. The provider must implement the following interface:</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// An interface for providing Visiblox chart series.</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">interface</span> IChartTypeProvider
<span style="color: #008000;">&#123;</span>
  <span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
  <span style="color: #008080; font-style: italic;">/// Creates a suitable chart series for the given data</span>
  <span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
  IChartSeries GetSeries<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> boundObject<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<p>In most MVVM chart binding applications, you will probably want all the series to have the same type. To achieve this, we can create a simple implementation of this interface which always returns the same chart type:</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// A ChartTypeProvider that always returns the Visiblox series</span>
<span style="color: #008080; font-style: italic;">/// type that was supplied in the constructor.</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> DefaultChartTypeProvider <span style="color: #008000;">:</span> IChartTypeProvider
<span style="color: #008000;">&#123;</span>
  <span style="color: #0600FF; font-weight: bold;">private</span> Type _seriesType<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">public</span> DefaultChartTypeProvider<span style="color: #008000;">&#40;</span>Type seriesType<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    _seriesType <span style="color: #008000;">=</span> seriesType<span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">public</span> IChartSeries GetSeries<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> boundObject<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    var ctr <span style="color: #008000;">=</span> _seriesType<span style="color: #008000;">.</span><span style="color: #0000FF;">GetConstructor</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">new</span> Type<span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> <span style="color: #008000;">&#125;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>IChartSeries<span style="color: #008000;">&#41;</span>ctr<span style="color: #008000;">.</span><span style="color: #0000FF;">Invoke</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">new</span> <span style="color: #6666cc; font-weight: bold;">object</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> <span style="color: #008000;">&#125;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<p>In order to simplify the usage of this provider in XAML, we can provide a type converter which allows us to specify the required series type as a string, e.g. <code>ChartTypeProvider="LineSeries"</code>, this makes use of the same framework mechanisms that allow you to specify a <code>Fill</code> as a string, e.g. <code>Fill="Red"</code>, where the result will be to create the following, <code>new SolidColorBrush() { Color = Colors.Red }</code>, a suitable type converter is shown below:</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}<span style="color: #008000;">&#91;</span>TypeConverter<span style="color: #008000;">&#40;</span><span style="color: #008000;">typeof</span><span style="color: #008000;">&#40;</span>StringToChartTypeProvider<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">interface</span> IChartTypeProvider
<span style="color: #008000;">&#123;</span>
   <span style="color: #008000;">...</span>
<span style="color: #008000;">&#125;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// A type converter that converts a string into a FixedChartTypeProvider. For example</span>
<span style="color: #008080; font-style: italic;">/// &quot;LineSeries&quot; is converted into a FixedChartTypeProvider which</span>
<span style="color: #008080; font-style: italic;">/// always returns Visblox.Chart.LineSeries instances</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> StringToChartTypeProvider <span style="color: #008000;">:</span> TypeConverter
<span style="color: #008000;">&#123;</span>
  <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">object</span> ConvertFrom<span style="color: #008000;">&#40;</span>ITypeDescriptorContext context,
    CultureInfo culture, <span style="color: #6666cc; font-weight: bold;">object</span> value<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>value <span style="color: #008000;">is</span> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
      var visibloxAssembly <span style="color: #008000;">=</span> <span style="color: #008000;">typeof</span><span style="color: #008000;">&#40;</span>Chart<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Assembly</span><span style="color: #008000;">;</span>
      var seriesType <span style="color: #008000;">=</span> visibloxAssembly<span style="color: #008000;">.</span><span style="color: #0000FF;">GetType</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Visiblox.Charts.&quot;</span> <span style="color: #008000;">+</span> value<span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">new</span> DefaultChartTypeProvider<span style="color: #008000;">&#40;</span>seriesType<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ConvertFrom</span><span style="color: #008000;">&#40;</span>context, culture, value<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">bool</span> CanConvertFrom<span style="color: #008000;">&#40;</span>ITypeDescriptorContext context, Type sourceType<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>sourceType <span style="color: #008000;">==</span> <span style="color: #008000;">typeof</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">.</span><span style="color: #0000FF;">CanConvertFrom</span><span style="color: #008000;">&#40;</span>context, sourceType<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<h2>A Simple Example</h2>
<p>We&#8217;ll start with a simple example, binding a collection of collections, in this case the <a href="http://en.wikipedia.org/wiki/Harmonic">harmonic vibrations of a string</a>. The series are created as follows:</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}  <span style="color: #0600FF; font-weight: bold;">public</span> MainPage<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    InitializeComponent<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// a collection of collections</span>
    var harmonics <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> List<span style="color: #008000;">&lt;</span>List<span style="color: #008000;">&lt;</span>Point<span style="color: #008000;">&gt;&gt;</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// plot each harmonic frequency</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> frequency <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">;</span> frequency <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">5</span> <span style="color: #008000;">;</span>frequency<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
      <span style="color: #008080; font-style: italic;">// create the upper and lower component</span>
      var upperHarmonic <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> List<span style="color: #008000;">&lt;</span>Point<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      var lowerHarmonic <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> List<span style="color: #008000;">&lt;</span>Point<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">double</span> phase <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> phase <span style="color: #008000;">&lt;</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">PI</span><span style="color: #008000;">;</span> phase<span style="color: #008000;">+=</span> <span style="color: #008000;">&#40;</span>Math<span style="color: #008000;">.</span><span style="color: #0000FF;">PI</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #008000;">&#123;</span>
        upperHarmonic<span style="color: #008000;">.</span><span style="color: #0000FF;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">new</span> Point<span style="color: #008000;">&#40;</span>phase, Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">&#40;</span>phase <span style="color: #008000;">*</span> frequency<span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> frequency <span style="color: #008000;">*</span> <span style="color: #FF0000;">2.5</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        lowerHarmonic<span style="color: #008000;">.</span><span style="color: #0000FF;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">new</span> Point<span style="color: #008000;">&#40;</span>phase, Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">&#40;</span>phase <span style="color: #008000;">*</span> frequency <span style="color: #008000;">+</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">PI</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> frequency <span style="color: #008000;">*</span> <span style="color: #FF0000;">2.5</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      <span style="color: #008000;">&#125;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// add each to the collection</span>
      harmonics<span style="color: #008000;">.</span><span style="color: #0000FF;">Add</span><span style="color: #008000;">&#40;</span>upperHarmonic<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
      harmonics<span style="color: #008000;">.</span><span style="color: #0000FF;">Add</span><span style="color: #008000;">&#40;</span>lowerHarmonic<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
&nbsp;
    <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DataContext</span> <span style="color: #008000;">=</span> harmonics<span style="color: #008000;">;</span>      
  <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<p>We can then use the attached properties defined above to bind this data to the chart. Note, because the bound data is a collection of collections (rather than a collection of items which expose the child collection via a property), the optional <code>ItemsSourcePath</code> is not required:</p>
<div class="wp_syntax"><div class="code">{% highlight xml %}<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;UserControl.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Palette</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">&quot;palette&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:LineSeries&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;Black&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:LineSeries&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;Black&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:LineSeries&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;Red&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:LineSeries&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;Red&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Palette<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/UserControl.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">&quot;LayoutRoot&quot;</span> <span style="color: #000066;">Background</span>=<span style="color: #ff0000;">&quot;White&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Chart</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">&quot;chart&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">Palette</span>=<span style="color: #ff0000;">&quot;{StaticResource palette}&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">LegendVisibility</span>=<span style="color: #ff0000;">&quot;Collapsed&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">Title</span>=<span style="color: #ff0000;">&quot;Modes of a vibrating string&quot;</span>               </span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.ChartTypeProvider</span>=<span style="color: #ff0000;">&quot;LineSeries&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.XValuePath</span>=<span style="color: #ff0000;">&quot;X&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.YValuePath</span>=<span style="color: #ff0000;">&quot;Y&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.Source</span>=<span style="color: #ff0000;">&quot;{Binding}&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>{% endhighlight %}
</div>
</div>
<p>Whilst the <code>MultiSeries</code> class allows you to specify the chart type via <code>ChartTypeProvider</code>, it does not provide a mechanism for styling the various series which it produces based on the supplied <code>Source</code>. However, styling can be achieved using the chart&#8217;s <code>Palette</code>, which is a collection of <code>Style</code> instances which are applied to the series in order.</p>
<p>The resulting chart is shown below:</p>
<p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/03/harmonic.png" alt="" title="harmonic" width="389" height="253" class="aligncenter size-full wp-image-1247" /></p>
<h2>A More Complex MVVM Example</h2>
<p>In this example, rather than binding a collection of collections, the following model is bound:</p>
<p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/03/MultiBindingExample.png" alt="" title="MultiBindingExample" width="600" height="208" class="aligncenter size-full wp-image-1254" /></p>
<p><code>CompanySalesViewModel</code> has a collection of <code>SalesTeamViewModel</code> instances, each of these has a name, <code>TeamName</code>, and a collection of <code>SalesInRegionViewModel</code> instances. Note, <code>SalesTeamViewModel</code> also has a string indexer property which will be used to bind this model to a <code>DataGrid</code>.</p>
<p>A custom <code>ChartTypeProvider</code> is used so that we can select chart types based on the bound <code>SalesTeamViewModel</code>:</p>
<div class="wp_syntax"><div class="code">{% highlight csharp %}<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> SalesTypeProvider <span style="color: #008000;">:</span> IChartTypeProvider
<span style="color: #008000;">&#123;</span>
  <span style="color: #0600FF; font-weight: bold;">public</span> IChartSeries GetSeries<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> boundObject<span style="color: #008000;">&#41;</span>
  <span style="color: #008000;">&#123;</span>
    var viewModel <span style="color: #008000;">=</span> boundObject <span style="color: #0600FF; font-weight: bold;">as</span> SalesTeamViewModel<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>viewModel<span style="color: #008000;">.</span><span style="color: #0000FF;">TeamName</span> <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;Target&quot;</span><span style="color: #008000;">&#41;</span>
      <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">new</span> LineSeries<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
      <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">new</span> ColumnSeries<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>{% endhighlight %}
</div>
</div>
<p>The view model is bound to a chart and is also bound to a <code>DataGrid</code> as follows. Note this time the <code>ItemsSourcePath</code> is used to bind the <code>TeamSales</code> property of each <code>SalesTeamViewModel</code>:</p>
<div class="wp_syntax"><div class="code">{% highlight xml %}<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;UserControl.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DropShadowEffect</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">&quot;shadow&quot;</span> <span style="color: #000066;">Opacity</span>=<span style="color: #ff0000;">&quot;0.3&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
&nbsp;
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;UIElement&quot;</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">&quot;collapsedStyle&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;Visibility&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;Collapsed&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
  <span style="color: #808080; font-style: italic;">&lt;!-- a base style for column series --&gt;</span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:ColumnSeries&quot;</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">&quot;columnBaseStyle&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;PointStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;White&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;PointStrokeThickness&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;0.5&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;Effect&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;{StaticResource shadow}&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
  <span style="color: #808080; font-style: italic;">&lt;!-- a Visiblox palette --&gt;</span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Palette</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">&quot;palette&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:ColumnSeries&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">BasedOn</span>=<span style="color: #ff0000;">&quot;{StaticResource columnBaseStyle}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;PointFill&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;#4f81bd&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:ColumnSeries&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">BasedOn</span>=<span style="color: #ff0000;">&quot;{StaticResource columnBaseStyle}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;PointFill&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;#c0504d&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:ColumnSeries&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">BasedOn</span>=<span style="color: #ff0000;">&quot;{StaticResource columnBaseStyle}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;PointFill&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;#9bbb59&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Style</span> <span style="color: #000066;">TargetType</span>=<span style="color: #ff0000;">&quot;vis:LineSeries&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStroke&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;#8064a2&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;LineStrokeThickness&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;4&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Setter</span> <span style="color: #000066;">Property</span>=<span style="color: #ff0000;">&quot;Effect&quot;</span> <span style="color: #000066;">Value</span>=<span style="color: #ff0000;">&quot;{StaticResource shadow}&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Style<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Palette<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/UserControl.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">&quot;LayoutRoot&quot;</span> <span style="color: #000066;">Background</span>=<span style="color: #ff0000;">&quot;White&quot;</span></span>
<span style="color: #009900;">      <span style="color: #000066;">util:GridUtils.RowDefinitions</span>=<span style="color: #ff0000;">&quot;,Auto&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Chart</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">&quot;chart&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">Title</span>=<span style="color: #ff0000;">&quot;Global Team Sales&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">LegendTitle</span>=<span style="color: #ff0000;">&quot;Team&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">Palette</span>=<span style="color: #ff0000;">&quot;{StaticResource palette}&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.XValuePath</span>=<span style="color: #ff0000;">&quot;Region&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.YValuePath</span>=<span style="color: #ff0000;">&quot;Sales&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.TitlePath</span>=<span style="color: #ff0000;">&quot;TeamName&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.ItemsSourcePath</span>=<span style="color: #ff0000;">&quot;TeamSales&quot;</span></span>
<span style="color: #009900;">              <span style="color: #000066;">local:MultiSeries.Source</span>=<span style="color: #ff0000;">&quot;{Binding SalesTeams}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiSeries.ChartTypeProvider<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:SalesTypeProvider</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiSeries.ChartTypeProvider<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Chart.XAxis<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:CategoryAxis</span> <span style="color: #000066;">GridlineStyle</span>=<span style="color: #ff0000;">&quot;{StaticResource collapsedStyle}&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Chart.XAxis<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Chart<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGrid</span> <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">&quot;1&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">ItemsSource</span>=<span style="color: #ff0000;">&quot;{Binding SalesTeams}&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">AutoGenerateColumns</span>=<span style="color: #ff0000;">&quot;False&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGrid.Columns<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGridTextColumn</span> <span style="color: #000066;">Binding</span>=<span style="color: #ff0000;">&quot;{Binding TeamName}&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">Header</span>=<span style="color: #ff0000;">&quot;Team&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">IsReadOnly</span>=<span style="color: #ff0000;">&quot;True&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGridTextColumn</span> <span style="color: #000066;">Binding</span>=<span style="color: #ff0000;">&quot;{Binding [US]}&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">Header</span>=<span style="color: #ff0000;">&quot;US&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGridTextColumn</span> <span style="color: #000066;">Binding</span>=<span style="color: #ff0000;">&quot;{Binding [UK]}&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">Header</span>=<span style="color: #ff0000;">&quot;UK&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGridTextColumn</span> <span style="color: #000066;">Binding</span>=<span style="color: #ff0000;">&quot;{Binding [Germany]}&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">Header</span>=<span style="color: #ff0000;">&quot;Germany&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGridTextColumn</span> <span style="color: #000066;">Binding</span>=<span style="color: #ff0000;">&quot;{Binding [Japan]}&quot;</span></span>
<span style="color: #009900;">                              <span style="color: #000066;">Header</span>=<span style="color: #ff0000;">&quot;Japan&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/sdk:DataGrid.Columns<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/sdk:DataGrid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>{% endhighlight %}
</div>
</div>
<p>The result is show below, note that updating the data in the grid causes the chart to update accordingly:</p>
<div style="text-align: center;"><object width="400" height="300" data="data:application/x-silverlight," type="application/x-silverlight-2" ><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/03/VisibloxMultiSeriesBinding.xap"/><a href="http://go.microsoft.com/fwlink/?LinkID=124807"  style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none"/></a></object></div>
<p>You can download the full sourcecode for this example: <a href='http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/03/VisibloxMultiSeriesBinding2.zip'>VisibloxMultiSeriesBinding.zip</a></p>
<p>Regards, Colin E.</p>
